<div class="game-page">

  <!-- LOADING -->
  <div class="loading-overlay" *ngIf="isLoading">
    <div class="loading-spinner">Loading...</div>
  </div>

  <!-- TITLU -->
  <header class="game-header">
    <h1><span class="icon">ğŸ®</span> Game Mode</h1>
    <button class="home-btn" (click)="goHome()">ğŸ  Home</button>
  </header>

  <!-- INFO SUS: avatar + coins -->
  <section class="game-info">

    <!-- AVATAR -->
    <div class="avatar-info" (click)="openAvatarModal()">
      <div class="avatar-circle">
        <img
          *ngIf="selectedAvatar"
          [src]="selectedAvatar.imageUrl"
          [alt]="selectedAvatar.name"
        />
      </div>
      <div class="avatar-text">
        <div class="label">Current avatar</div>
        <div class="name">
          {{ selectedAvatar?.name || 'Unknown Artist' }}
        </div>
        <div class="hint">(click to change)</div>
      </div>
    </div>

    <!-- RETRO ROOM -->
    <div class="retro-room-button" (click)="openRetroRoom()">
      ğŸ–¼ï¸ Retro Room
    </div>

    <!-- COINS -->
    <div class="coins-info">
      <span class="coins-label">Coins</span>
      <span class="coins-value">ğŸª™ {{ gameState.coins }}</span>
    </div>

  </section>

  <!-- MODURI DE JOC -->
  <section class="modes-section" *ngIf="selectedAvatar">
    <h2>Choose your mode</h2>

    <div class="modes-buttons">
      <button class="mode-btn" (click)="startSinglePlayer()">
        Single Player
      </button>

      <button class="mode-btn secondary" (click)="startMultiPlayer()">
        Multiplayer
      </button>
    </div>
  </section>

  <!-- MODAL AVATAR -->
  <div class="modal-backdrop" *ngIf="showAvatarModal">
    <div class="modal">
      <h2>Choose your Avatar</h2>
      <p class="modal-subtitle">
        Unlock famous artists with coins. You always have a default avatar.
      </p>

      <div class="avatars-grid">
        <button
          *ngFor="let avatar of avatars"
          class="avatar-card"
          (click)="selectAvatar(avatar)"
        >
          <div class="avatar-img">
            <img [src]="avatar.imageUrl" [alt]="avatar.name" />
          </div>

          <div class="avatar-name">{{ avatar.name }}</div>

          <div class="avatar-cost">
            <span *ngIf="avatar.requiredCoins === 0">Free</span>
            <span *ngIf="avatar.requiredCoins > 0">
              ğŸª™ {{ avatar.requiredCoins }} coins
            </span>
          </div>
        </button>
      </div>

      <p class="coins-info-modal">
        Your coins: <strong>ğŸª™ {{ gameState.coins }}</strong>
      </p>
    </div>
  </div>

  <!-- ===================== -->
  <!-- RETRO ROOM POPUP -->
  <!-- ===================== -->

  <div class="retro-overlay" *ngIf="isRetroRoomOpen">

    <div class="retro-popup">

      <button class="close-btn" (click)="closeRetroRoom()">âœ–</button>

      <!-- DACA EXISTA POSTERE IN CATALOG -->
      <ng-container *ngIf="posterCatalog.length > 0; else emptyRoom">

        <!-- SAGEATA STANGA -->
        <button
          class="nav left"
          (click)="prevPoster()"
          [disabled]="currentPosterIndex === 0"
        >
          â¬…
        </button>

        <!-- POSTER -->
        <div class="poster-container">

          <img
            [src]="currentPoster().imageUrl"
            class="poster-preview"
            [class.locked]="!isOwned(currentPoster())"
          />

          <!-- LOCK & BUY -->
          <div
            class="lock-overlay"
            *ngIf="!isOwned(currentPoster())"
          >
            <p class="price">
              ğŸª™ {{ currentPoster().price }}
            </p>
            <button (click)="buyPoster(currentPoster())">
              Buy poster
            </button>
          </div>

          <p class="poster-title">
            {{ currentPoster().name }}
          </p>

        </div>

        <!-- SAGEATA DREAPTA -->
        <!-- <button
          class="nav right"
          (click)="nextPoster()"
          [disabled]="currentPosterIndex === posterCatalog.length - 1"
        >
          â¡
        </button> -->
        <button
  class="nav right"
  (click)="debugNextPoster()"
>
  â¡
</button>


      </ng-container>

      <!-- FARA POSTERE -->
      <ng-template #emptyRoom>
        <p class="empty-text">
          No posters yet. Win games & buy some! ğŸ¶
        </p>
      </ng-template>

    </div>
  </div>

</div>
