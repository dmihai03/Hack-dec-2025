<div class="game-page">

  <!-- LOADING -->
  <div class="loading-overlay" *ngIf="isLoading">
    <div class="loading-spinner">Loading...</div>
  </div>

  <!-- TITLU -->
  <header class="game-header">
    <span class="icon">ğŸ®</span>
    <h1>Game Mode</h1>
  </header>

  <!-- INFO SUS: avatar + coins -->
  <section class="game-info">
    <div class="avatar-info" (click)="openAvatarModal()">
      <div class="avatar-circle">
        <img *ngIf="selectedAvatar"
             [src]="selectedAvatar.imageUrl"
             [alt]="selectedAvatar.name">
      </div>
      <div class="avatar-text">
        <div class="label">Current avatar</div>
        <div class="name">
          {{ selectedAvatar?.name || 'Unknown Artist' }}
        </div>
        <div class="hint">(click to change)</div>
      </div>
    </div>
      <div class="retro-room-button" (click)="openRetroRoom()">
  ğŸ–¼ï¸ Retro Room
    </div>


    <div class="coins-info">
      <span class="coins-label">Coins</span>
      <span class="coins-value">ğŸª™ {{ gameState.coins }}</span>
    </div>
  </section>

  <!-- MODURI DE JOC (apar doar dupÄƒ ce a ales avatar) -->
  <section class="modes-section" *ngIf="selectedAvatar">
    <h2>Choose your mode</h2>

    <div class="modes-buttons">
      <button class="mode-btn" (click)="startSinglePlayer()">
        Single Player
      </button>

      <button class="mode-btn secondary" (click)="startMultiPlayer()">
        Multiplayer
      </button>
    </div>
  </section>

  <!-- POPUP CHOOSE AVATAR -->
  <div class="modal-backdrop" *ngIf="showAvatarModal">
    <div class="modal">
      <h2>Choose your Avatar</h2>
      <p class="modal-subtitle">
        Unlock famous artists with coins. You always have a default avatar.
      </p>

      <div class="avatars-grid">
        <button
          *ngFor="let avatar of avatars"
          class="avatar-card"
          [class.owned]="gameState.isAvatarOwned(avatar.id)"
          [class.locked]="!gameState.isAvatarOwned(avatar.id) && !canAffordAvatar(avatar)"
          [class.purchasable]="!gameState.isAvatarOwned(avatar.id) && canAffordAvatar(avatar)"
          (click)="selectAvatar(avatar)"
        >
          <div class="avatar-img">
            <img [src]="avatar.imageUrl" [alt]="avatar.name">
            <div class="owned-badge" *ngIf="gameState.isAvatarOwned(avatar.id)">âœ“</div>
            <div class="lock-icon" *ngIf="!gameState.isAvatarOwned(avatar.id) && !canAffordAvatar(avatar)">ğŸ”’</div>
          </div>
          <div class="avatar-name">{{ avatar.name }}</div>
          <div class="avatar-cost">
            <span *ngIf="avatar.requiredCoins === 0">Free</span>
            <span *ngIf="avatar.requiredCoins > 0 && gameState.isAvatarOwned(avatar.id)" class="owned-text">Owned</span>
            <span *ngIf="avatar.requiredCoins > 0 && !gameState.isAvatarOwned(avatar.id)">
              ğŸª™ {{ avatar.requiredCoins }} coins
            </span>
          </div>
        </button>
      </div>

      <p class="coins-info-modal">
        Your coins: <strong>ğŸª™ {{ gameState.coins }}</strong>
      </p>
    </div>
  </div>
  <div class="retro-overlay" *ngIf="isRetroRoomOpen">

  <div class="retro-popup">

    <button class="close-btn" (click)="closeRetroRoom()">âœ–</button>

    <ng-container *ngIf="gameState.posters.length > 0; else emptyRoom">

      <button class="nav left"
              (click)="prevPoster()"
              [disabled]="currentPosterIndex === 0">
        â¬…
      </button>

      <div class="poster-container">
  <img
    [src]="gameState.posters[currentPosterIndex].imageUrl"
    class="poster-preview"
  />
  <p class="poster-title">
    {{ gameState.posters[currentPosterIndex].name }}
  </p>
</div>


      <button class="nav right"
              (click)="nextPoster()"
              [disabled]="currentPosterIndex === gameState.posters.length - 1">
        â¡
      </button>

    </ng-container>

    <ng-template #emptyRoom>
      <p class="empty-text">No posters yet. Win games & buy some! ğŸ¶</p>
    </ng-template>

  </div>
</div>


</div>
